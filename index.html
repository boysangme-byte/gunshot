<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>ÏïÖÎ†πÏÇ¨ÎÉ• v10</title>
  <style>
    :root { --bg:#0a0014; --panel:#150b2c; --line:#3a2360; --text:#e9d7ff; --accent:#d080ff; }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body { background:var(--bg); color:var(--text); font-family:sans-serif; display:flex; justify-content:center; padding:10px; }
    .stage { width:100%; max-width:960px; position:relative; }
    #game { width:100%; aspect-ratio:16/9; background:#000; border:2px solid var(--line); border-radius:10px; display:block; touch-action:none; }
    .hud { display:flex; gap:10px; margin-top:5px; font-size:14px; flex-wrap:wrap; }
    .hud div { background:#150b2c; border:1px solid var(--line); padding:4px 8px; border-radius:6px; }
    .mobile-ui { position:absolute; inset:0; pointer-events:none; }
    .joystick { position:absolute; left:15px; bottom:20px; width:120px; height:120px; background:#2224; border:2px solid var(--accent); border-radius:50%; pointer-events:auto; touch-action:none; }
    .stick { position:absolute; left:35px; top:35px; width:50px; height:50px; background:#d080ff88; border-radius:50%; }
    .buttons { position:absolute; right:20px; bottom:20px; display:flex; flex-direction:column; gap:10px; pointer-events:auto; }
    .btn { width:80px; height:40px; background:#2a1658; color:white; border-radius:8px; border:1px solid #5b3db3; font-size:14px; }
  </style>
</head>
<body>
  <div class="stage">
    <canvas id="game"></canvas>
    <div class="hud">
      <div>Ï†êÏàò: <span id="score">0</span></div>
      <div>Î¨¥Í∏∞: <span id="weapon">Pistol</span></div>
      <div>Ï≤¥Î†•: <span id="hp">5</span></div>
    </div>

    <!-- üì± Î™®Î∞îÏùº UI -->
    <div class="mobile-ui">
      <div class="joystick" id="joystick">
        <div class="stick" id="stick"></div>
      </div>
      <div class="buttons">
        <button class="btn" id="fireBtn">FIRE</button>
        <button class="btn" id="w1">1</button>
        <button class="btn" id="w2">2</button>
        <button class="btn" id="w3">3</button>
      </div>
    </div>
  </div>

<script>
const canvas=document.getElementById("game"),ctx=canvas.getContext("2d");
function resize(){canvas.width=canvas.clientWidth;canvas.height=canvas.clientHeight;}
window.addEventListener("resize",resize);resize();

let player={x:200,y:200,r:20,hp:5,speed:200};
let bullets=[];
let weapon="pistol"; 
let score=0;

// üî´ Î∞úÏÇ¨
function fire(){
  const angle=Math.random()*Math.PI*2;
  bullets.push({x:player.x,y:player.y,dx:Math.cos(angle)*400,dy:Math.sin(angle)*400,r:4});
}

// üéÆ Ï°∞Ïù¥Ïä§Ìã±
const joystick=document.getElementById("joystick"), stick=document.getElementById("stick");
let joyActive=false,joyDX=0,joyDY=0;
joystick.addEventListener("touchstart",e=>{joyActive=true;e.preventDefault();});
joystick.addEventListener("touchend",e=>{joyActive=false;joyDX=0;joyDY=0;stick.style.left="35px";stick.style.top="35px";});
joystick.addEventListener("touchmove",e=>{
  e.preventDefault();
  const rect=joystick.getBoundingClientRect();
  const touch=e.touches[0];
  const dx=touch.clientX-(rect.left+rect.width/2);
  const dy=touch.clientY-(rect.top+rect.height/2);
  const dist=Math.min(Math.hypot(dx,dy),50);
  const angle=Math.atan2(dy,dx);
  joyDX=Math.cos(angle)*dist/50;
  joyDY=Math.sin(angle)*dist/50;
  stick.style.left=35+joyDX*30+"px";
  stick.style.top=35+joyDY*30+"px";
});

// üì± Î≤ÑÌäº
document.getElementById("fireBtn").addEventListener("touchstart",()=>{fire();});
document.getElementById("w1").addEventListener("click",()=>{weapon="pistol";});
document.getElementById("w2").addEventListener("click",()=>{weapon="shotgun";});
document.getElementById("w3").addEventListener("click",()=>{weapon="laser";});

function update(dt){
  player.x+=joyDX*player.speed*dt;
  player.y+=joyDY*player.speed*dt;
  bullets.forEach(b=>{b.x+=b.dx*dt;b.y+=b.dy*dt;});
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="cyan";
  ctx.beginPath();ctx.arc(player.x,player.y,player.r,0,Math.PI*2);ctx.fill();
  ctx.fillStyle="yellow";
  bullets.forEach(b=>{ctx.beginPath();ctx.arc(b.x,b.y,b.r,0,Math.PI*2);ctx.fill();});
}

let last=0;
function loop(t){const dt=(t-last)/1000;last=t;update(dt);draw();requestAnimationFrame(loop);}
requestAnimationFrame(loop);
</script>
</body>
</html>
